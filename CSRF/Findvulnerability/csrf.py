# The goal of this script is to check wheather a router's interface is vulnerable to
# CSRF attack 
# The logic of this script is:
# 		a.run the imagine
# 		b.get the default setting of DNS and save the number 
# 		c.try to use the following code to change the setting:
# 			http://192.168.1.1/userRpm/LanDhcpServerRpm.htm?dhcpserver=1&ip1=192.168.1.100&ip2=192.168.1.199&Lease=120&gateway=0.0.0.0&domain=&dnsserver=2.2.2.2&dnsserver2=4.4.4.4&Save=%B1%A3+%B4%E6
# 		d.recheck the setting, if it is 2.2.2.2 or 4.4.4.4 , then it is vulnerable
# 		e.otherwise it is safe


#I have already have the assumption that all the imagine is stored in 
#/firmware/scratch/run 
# there are lists of files 
# /home/naghceuz/firmware/scratch/run

import os, os.path
import urllib2
import sys 
import subprocess

# directory where you saved your imagine
PATH = "/home/naghceuz/firmware/scratch/run"

# path, dirs, files = os.walk("/home/naghceuz/firmware/scratch/run").next()
# file_count = len(files)

allthefile = os.listdir("/home/naghceuz/firmware/scratch/run");

print allthefile;
s = "they are " + str(len(allthefile)) + " imagine need to be checked"
print s

#changing the working directory to run file where all the imagine located 
dir1 = os.chdir('/home/naghceuz/firmware/scratch/run')
print("the current path: " + os.getcwd())
print("the current path contain the list of imagines" + str(os.listdir(PATH)) ) 
print("There are " + str(len(os.listdir(PATH)))  + " needed to be checked")

